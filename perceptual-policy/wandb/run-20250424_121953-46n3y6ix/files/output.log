Using device: cuda
buffer limit is =  100000
Episode: 0, total numsteps: 0, return: -1.0
Episode: 0, total numsteps: 0, return: -1.0
Episode: 0, total numsteps: 0, return: 5.0
Episode: 0, total numsteps: 0, return: 5.0
Episode: 0, total numsteps: 0, return: -1.0
Episode: 1, total numsteps: 100, return: -1.0
Cumulative Returns: -1.0
Episode: 2, total numsteps: 200, return: -1.0
Cumulative Returns: -2.0
Episode: 3, total numsteps: 300, return: -1.0
Cumulative Returns: -3.0
Episode: 4, total numsteps: 400, return: -1.0
Cumulative Returns: -4.0
Episode: 5, total numsteps: 500, return: -1.0
Cumulative Returns: -5.0
Episode: 6, total numsteps: 600, return: 5.0
Cumulative Returns: 0.0
Episode: 7, total numsteps: 700, return: 5.0
Cumulative Returns: 5.0
Episode: 8, total numsteps: 800, return: -1.0
Cumulative Returns: 4.0
Episode: 9, total numsteps: 900, return: 5.0
Cumulative Returns: 9.0
Episode: 10, total numsteps: 1000, return: -1.0
Cumulative Returns: 8.0
Episode: 11, total numsteps: 1100, return: -1.0
Cumulative Returns: 7.0
Episode: 12, total numsteps: 1200, return: 5.0
Cumulative Returns: 12.0
Episode: 13, total numsteps: 1300, return: 5.0
Cumulative Returns: 17.0
Episode: 14, total numsteps: 1400, return: 5.0
Cumulative Returns: 22.0
Episode: 15, total numsteps: 1500, return: 5.0
Cumulative Returns: 27.0
Episode: 16, total numsteps: 1600, return: 5.0
Cumulative Returns: 32.0
Episode: 17, total numsteps: 1700, return: 5.0
Cumulative Returns: 37.0
Episode: 18, total numsteps: 1800, return: 5.0
Cumulative Returns: 42.0
Episode: 19, total numsteps: 1900, return: 5.0
Cumulative Returns: 47.0
Episode: 20, total numsteps: 2000, return: 5.0
Cumulative Returns: 52.0
Episode: 21, total numsteps: 2100, return: 5.0
Cumulative Returns: 57.0
Episode: 22, total numsteps: 2200, return: 5.0
Cumulative Returns: 62.0
Episode: 23, total numsteps: 2300, return: 5.0
Cumulative Returns: 67.0
Episode: 24, total numsteps: 2400, return: -1.0
Cumulative Returns: 66.0
Episode: 25, total numsteps: 2500, return: -1.0
Cumulative Returns: 65.0
Episode: 26, total numsteps: 2600, return: -1.0
Cumulative Returns: 64.0
Episode: 27, total numsteps: 2700, return: -1.0
Cumulative Returns: 63.0
Episode: 28, total numsteps: 2800, return: -1.0
Cumulative Returns: 62.0
Episode: 29, total numsteps: 2900, return: -1.0
Cumulative Returns: 61.0
Episode: 30, total numsteps: 3000, return: -1.0
Cumulative Returns: 60.0
Episode: 31, total numsteps: 3100, return: -1.0
Cumulative Returns: 59.0
Episode: 32, total numsteps: 3200, return: -1.0
Cumulative Returns: 58.0
Episode: 33, total numsteps: 3300, return: -1.0
Cumulative Returns: 57.0
Episode: 34, total numsteps: 3400, return: -1.0
Cumulative Returns: 56.0
Episode: 35, total numsteps: 3500, return: -1.0
Cumulative Returns: 55.0
Episode: 36, total numsteps: 3600, return: -1.0
Cumulative Returns: 54.0
Episode: 37, total numsteps: 3700, return: -1.0
Cumulative Returns: 53.0
Episode: 38, total numsteps: 3800, return: -1.0
Cumulative Returns: 52.0
Episode: 39, total numsteps: 3900, return: -1.0
Cumulative Returns: 51.0
Episode: 40, total numsteps: 4000, return: -1.0
Cumulative Returns: 50.0
Episode: 41, total numsteps: 4100, return: -1.0
Cumulative Returns: 49.0
Episode: 42, total numsteps: 4200, return: -1.0
Cumulative Returns: 48.0
Episode: 43, total numsteps: 4300, return: -1.0
Cumulative Returns: 47.0
Episode: 44, total numsteps: 4400, return: -1.0
Cumulative Returns: 46.0
Episode: 45, total numsteps: 4500, return: -1.0
Cumulative Returns: 45.0
Episode: 46, total numsteps: 4600, return: -1.0
Cumulative Returns: 44.0
Episode: 47, total numsteps: 4700, return: -1.0
Cumulative Returns: 43.0
Episode: 48, total numsteps: 4800, return: -1.0
Cumulative Returns: 42.0
Episode: 49, total numsteps: 4900, return: -1.0
Cumulative Returns: 41.0
Episode: 49, total numsteps: 5000, return: -1.0
Episode: 49, total numsteps: 5000, return: -1.0
Episode: 49, total numsteps: 5000, return: -1.0
Episode: 49, total numsteps: 5000, return: -1.0
Episode: 49, total numsteps: 5000, return: -1.0
Episode: 50, total numsteps: 5000, return: -1.0
Cumulative Returns: 40.0
Episode: 51, total numsteps: 5100, return: -1.0
Cumulative Returns: 39.0
Episode: 52, total numsteps: 5200, return: -1.0
Cumulative Returns: 38.0
Episode: 53, total numsteps: 5300, return: -1.0
Cumulative Returns: 37.0
Episode: 54, total numsteps: 5400, return: -1.0
Cumulative Returns: 36.0
Episode: 55, total numsteps: 5500, return: -1.0
Cumulative Returns: 35.0
Episode: 56, total numsteps: 5600, return: -1.0
Cumulative Returns: 34.0
Episode: 57, total numsteps: 5700, return: -1.0
Cumulative Returns: 33.0
Episode: 58, total numsteps: 5800, return: -1.0
Cumulative Returns: 32.0
Episode: 59, total numsteps: 5900, return: -1.0
Cumulative Returns: 31.0
Episode: 60, total numsteps: 6000, return: -1.0
Cumulative Returns: 30.0
Episode: 61, total numsteps: 6100, return: -1.0
Cumulative Returns: 29.0
Episode: 62, total numsteps: 6200, return: -1.0
Cumulative Returns: 28.0
Episode: 63, total numsteps: 6300, return: -1.0
Cumulative Returns: 27.0
Episode: 64, total numsteps: 6400, return: -1.0
Cumulative Returns: 26.0
Episode: 65, total numsteps: 6500, return: -1.0
Cumulative Returns: 25.0
Episode: 66, total numsteps: 6600, return: -1.0
Cumulative Returns: 24.0
Episode: 67, total numsteps: 6700, return: -1.0
Cumulative Returns: 23.0
Episode: 68, total numsteps: 6800, return: -1.0
Cumulative Returns: 22.0
Episode: 69, total numsteps: 6900, return: -1.0
Cumulative Returns: 21.0
Episode: 70, total numsteps: 7000, return: -1.0
Cumulative Returns: 20.0
Episode: 71, total numsteps: 7100, return: -1.0
Cumulative Returns: 19.0
Episode: 72, total numsteps: 7200, return: -1.0
Cumulative Returns: 18.0
Episode: 73, total numsteps: 7300, return: -1.0
Cumulative Returns: 17.0
Episode: 74, total numsteps: 7400, return: -1.0
Cumulative Returns: 16.0
Episode: 75, total numsteps: 7500, return: -1.0
Cumulative Returns: 15.0
Episode: 76, total numsteps: 7600, return: -1.0
Cumulative Returns: 14.0
Episode: 77, total numsteps: 7700, return: -1.0
Cumulative Returns: 13.0
Episode: 78, total numsteps: 7800, return: -1.0
Cumulative Returns: 12.0
Episode: 79, total numsteps: 7900, return: -1.0
Cumulative Returns: 11.0
Episode: 80, total numsteps: 8000, return: -1.0
Cumulative Returns: 10.0
Episode: 81, total numsteps: 8100, return: -1.0
Cumulative Returns: 9.0
Episode: 82, total numsteps: 8200, return: -1.0
Cumulative Returns: 8.0
Episode: 83, total numsteps: 8300, return: -1.0
Cumulative Returns: 7.0
Episode: 84, total numsteps: 8400, return: -1.0
Cumulative Returns: 6.0
Episode: 85, total numsteps: 8500, return: -1.0
Cumulative Returns: 5.0
Episode: 86, total numsteps: 8600, return: -1.0
Cumulative Returns: 4.0
Episode: 87, total numsteps: 8700, return: -1.0
Cumulative Returns: 3.0
Episode: 88, total numsteps: 8800, return: -1.0
Cumulative Returns: 2.0
Episode: 89, total numsteps: 8900, return: -1.0
Cumulative Returns: 1.0
Episode: 90, total numsteps: 9000, return: -1.0
Cumulative Returns: 0.0
Episode: 91, total numsteps: 9100, return: -1.0
Cumulative Returns: -1.0
Episode: 92, total numsteps: 9200, return: -1.0
Cumulative Returns: -2.0
Episode: 93, total numsteps: 9300, return: -1.0
Cumulative Returns: -3.0
Episode: 94, total numsteps: 9400, return: -1.0
Cumulative Returns: -4.0
Episode: 95, total numsteps: 9500, return: -1.0
Cumulative Returns: -5.0
Episode: 96, total numsteps: 9600, return: -1.0
Cumulative Returns: -6.0
Episode: 97, total numsteps: 9700, return: -1.0
Cumulative Returns: -7.0
Episode: 98, total numsteps: 9800, return: -1.0
Cumulative Returns: -8.0
Episode: 99, total numsteps: 9900, return: -1.0
Cumulative Returns: -9.0
Episode: 99, total numsteps: 10000, return: -1.0
Episode: 99, total numsteps: 10000, return: -1.0
Episode: 99, total numsteps: 10000, return: -1.0
Episode: 99, total numsteps: 10000, return: -1.0
Episode: 99, total numsteps: 10000, return: -1.0
Episode: 100, total numsteps: 10000, return: -1.0
Cumulative Returns: -10.0
Episode: 101, total numsteps: 10100, return: -1.0
Cumulative Returns: -11.0
Episode: 102, total numsteps: 10200, return: -1.0
Cumulative Returns: -12.0
Episode: 103, total numsteps: 10300, return: -1.0
Cumulative Returns: -13.0
Episode: 104, total numsteps: 10400, return: -1.0
Cumulative Returns: -14.0
Episode: 105, total numsteps: 10500, return: -1.0
Cumulative Returns: -15.0
Episode: 106, total numsteps: 10600, return: -1.0
Cumulative Returns: -16.0
Episode: 107, total numsteps: 10700, return: -1.0
Cumulative Returns: -17.0
Episode: 108, total numsteps: 10800, return: -1.0
Cumulative Returns: -18.0
Episode: 109, total numsteps: 10900, return: -1.0
Cumulative Returns: -19.0
Episode: 110, total numsteps: 11000, return: -1.0
Cumulative Returns: -20.0
Episode: 111, total numsteps: 11100, return: -1.0
Cumulative Returns: -21.0
Episode: 112, total numsteps: 11200, return: -1.0
Cumulative Returns: -22.0
Episode: 113, total numsteps: 11300, return: -1.0
Cumulative Returns: -23.0
Episode: 114, total numsteps: 11400, return: -1.0
Cumulative Returns: -24.0
Episode: 115, total numsteps: 11500, return: -1.0
Cumulative Returns: -25.0
Episode: 116, total numsteps: 11600, return: -1.0
Cumulative Returns: -26.0
Episode: 117, total numsteps: 11700, return: -1.0
Cumulative Returns: -27.0
Episode: 118, total numsteps: 11800, return: -1.0
Cumulative Returns: -28.0
Episode: 119, total numsteps: 11900, return: -1.0
Cumulative Returns: -29.0
Episode: 120, total numsteps: 12000, return: -1.0
Cumulative Returns: -30.0
Episode: 121, total numsteps: 12100, return: -1.0
Cumulative Returns: -31.0
Episode: 122, total numsteps: 12200, return: -1.0
Cumulative Returns: -32.0
Episode: 123, total numsteps: 12300, return: -1.0
Cumulative Returns: -33.0
Episode: 124, total numsteps: 12400, return: -1.0
Cumulative Returns: -34.0
Episode: 125, total numsteps: 12500, return: -1.0
Cumulative Returns: -35.0
Episode: 126, total numsteps: 12600, return: -1.0
Cumulative Returns: -36.0
Episode: 127, total numsteps: 12700, return: -1.0
Cumulative Returns: -37.0
Episode: 128, total numsteps: 12800, return: -1.0
Cumulative Returns: -38.0
Episode: 129, total numsteps: 12900, return: -1.0
Cumulative Returns: -39.0
Episode: 130, total numsteps: 13000, return: -1.0
Cumulative Returns: -40.0
Episode: 131, total numsteps: 13100, return: -1.0
Cumulative Returns: -41.0
Episode: 132, total numsteps: 13200, return: -1.0
Cumulative Returns: -42.0
Episode: 133, total numsteps: 13300, return: -1.0
Cumulative Returns: -43.0
Episode: 134, total numsteps: 13400, return: -1.0
Cumulative Returns: -44.0
Episode: 135, total numsteps: 13500, return: -1.0
Cumulative Returns: -45.0
Episode: 136, total numsteps: 13600, return: -1.0
Cumulative Returns: -46.0
Episode: 137, total numsteps: 13700, return: -1.0
Cumulative Returns: -47.0
Episode: 138, total numsteps: 13800, return: -1.0
Cumulative Returns: -48.0
Episode: 139, total numsteps: 13900, return: -1.0
Cumulative Returns: -49.0
Episode: 140, total numsteps: 14000, return: -1.0
Cumulative Returns: -50.0
Episode: 141, total numsteps: 14100, return: -1.0
Cumulative Returns: -51.0
Episode: 142, total numsteps: 14200, return: -1.0
Cumulative Returns: -52.0
Episode: 143, total numsteps: 14300, return: -1.0
Cumulative Returns: -53.0
Episode: 144, total numsteps: 14400, return: -1.0
Cumulative Returns: -54.0
Episode: 145, total numsteps: 14500, return: -1.0
Cumulative Returns: -55.0
Episode: 146, total numsteps: 14600, return: -1.0
Cumulative Returns: -56.0
Episode: 147, total numsteps: 14700, return: -1.0
Cumulative Returns: -57.0
Episode: 148, total numsteps: 14800, return: -1.0
Cumulative Returns: -58.0
Episode: 149, total numsteps: 14900, return: -1.0
Cumulative Returns: -59.0
Episode: 149, total numsteps: 15000, return: -1.0
Episode: 149, total numsteps: 15000, return: -1.0
Episode: 149, total numsteps: 15000, return: -1.0
Episode: 149, total numsteps: 15000, return: -1.0
Episode: 149, total numsteps: 15000, return: -1.0
Episode: 150, total numsteps: 15000, return: -1.0
Cumulative Returns: -60.0
Episode: 151, total numsteps: 15100, return: -1.0
Cumulative Returns: -61.0
Episode: 152, total numsteps: 15200, return: -1.0
Cumulative Returns: -62.0
Episode: 153, total numsteps: 15300, return: -1.0
Cumulative Returns: -63.0
Episode: 154, total numsteps: 15400, return: -1.0
Cumulative Returns: -64.0
Episode: 155, total numsteps: 15500, return: -1.0
Cumulative Returns: -65.0
Episode: 156, total numsteps: 15600, return: -1.0
Cumulative Returns: -66.0
Episode: 157, total numsteps: 15700, return: -1.0
Cumulative Returns: -67.0
Episode: 158, total numsteps: 15800, return: -1.0
Cumulative Returns: -68.0
Episode: 159, total numsteps: 15900, return: -1.0
Cumulative Returns: -69.0
Episode: 160, total numsteps: 16000, return: -1.0
Cumulative Returns: -70.0
Episode: 161, total numsteps: 16100, return: -1.0
Cumulative Returns: -71.0
Episode: 162, total numsteps: 16200, return: -1.0
Cumulative Returns: -72.0
Traceback (most recent call last):
  File "/home/themandalorian/ETH/Thesis/perceptualpolicy/main-alm.py", line 274, in <module>
    alm_helper.train()
  File "/home/themandalorian/ETH/Thesis/perceptualpolicy/main-alm.py", line 141, in train
    self.agent.update(self._train_step)
  File "/home/themandalorian/ETH/Thesis/perceptualpolicy/alm.py", line 118, in update
    self.update_representation(std, step, log, metrics)
  File "/home/themandalorian/ETH/Thesis/perceptualpolicy/alm.py", line 129, in update_representation
    state_seq, action_seq, reward_seq, next_state_seq, done_seq = self.env_buffer.sample_seq(self.seq_len, self.batch_size)
  File "/home/themandalorian/ETH/Thesis/perceptualpolicy/utils/replay_buffer.py", line 32, in sample_seq
    obs, act, rew, next_obs, term = self._retrieve_batch(np.asarray([self._sample_idx(l) for _ in range(n)]), n, l)
  File "/home/themandalorian/ETH/Thesis/perceptualpolicy/utils/replay_buffer.py", line 32, in <listcomp>
    obs, act, rew, next_obs, term = self._retrieve_batch(np.asarray([self._sample_idx(l) for _ in range(n)]), n, l)
  File "/home/themandalorian/ETH/Thesis/perceptualpolicy/utils/replay_buffer.py", line 43, in _sample_idx
    idxs = np.arange(idx, idx+L)%self.buffer_limit
KeyboardInterrupt